{% extends 'base.html' %}
{% block content %}
<style>
    body {
        font-family: 'Segoe UI', sans-serif;
        background: #f5f7fa;
        color: #222;
        margin: 0;
    }

    h1 {
        text-align: center;
        padding: 30px 0 10px;
        color: #2c3e50;
        font-size: 2.5rem;
    }

    .filter-container {
        text-align: center;
        margin: 20px 0;
    }

    select {
        padding: 10px 15px;
        font-size: 1rem;
        border-radius: 8px;
        border: 1px solid #ccc;
        background: white;
    }

    .video-section {
        margin: 30px auto;
        width: 90%;
    }

    .category-title {
        margin: 10px 0 20px;
        font-size: 1.8rem;
        color: #34495e;
        text-align: left;
        border-bottom: 3px solid #27ae60;
        padding-bottom: 5px;
    }

    .video-grid {
        display: flex;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 20px;
    }

    .video-card {
        flex: 1 1 calc(33.333% - 20px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        background: white;
        border-radius: 10px;
        overflow: hidden;
    }

    .video-card iframe {
        width: 100%;
        height: 250px;
        border: none;
    }

    @media screen and (max-width: 992px) {
        .video-card {
            flex: 1 1 calc(50% - 20px);
        }
    }

    @media screen and (max-width: 600px) {
        .video-card {
            flex: 1 1 100%;
        }

        .video-card iframe {
            height: 200px;
        }
    }
</style>

<h1>Educational Videos</h1>

<div class="filter-container">
    <label for="category-select">Select Category:</label>
    <select id="category-select" onchange="filterVideos()">
        <option value="all">All</option>
        <option value="crops">Crops</option>
        <option value="vermi">Vermicompost</option>
        <option value="advanced">Advanced Farming</option>
    </select>
</div>

<!-- Crops -->
<div class="video-section" id="section-crops">
    <div class="category-title">Crops</div>
    <div class="video-grid">
        <div class="video-card"><iframe id="player1" src="https://www.youtube.com/embed/tOlVDxnGQfA?enablejsapi=1"
                allowfullscreen
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"></iframe>
        </div>
        <div class="video-card"><iframe id="player2" src="https://www.youtube.com/embed/K1kBDFXESXE?enablejsapi=1"
                allowfullscreen
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"></iframe>
        </div>
        <div class="video-card"><iframe id="player3" src="https://www.youtube.com/embed/ookOIp1EemA?enablejsapi=1"
                allowfullscreen
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"></iframe>
        </div>
    </div>
</div>

<!-- Vermicompost -->
<div class="video-section" id="section-vermi">
    <div class="category-title">Vermicompost</div>
    <div class="video-grid">
        <div class="video-card"><iframe id="player4" src="https://www.youtube.com/embed/3s6fU-hkfiI?enablejsapi=1"
                allowfullscreen
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"></iframe>
        </div>
        <div class="video-card"><iframe id="player5" src="https://www.youtube.com/embed/A4KKZPq-sQ8?enablejsapi=1"
                allowfullscreen
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"></iframe>
        </div>
        <div class="video-card"><iframe id="player6" src="https://www.youtube.com/embed/MrOH-bUi7AM?enablejsapi=1"
                allowfullscreen
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"></iframe>
        </div>
    </div>
</div>

<!-- Advanced Farming -->
<div class="video-section" id="section-advanced">
    <div class="category-title">Advanced Farming</div>
    <div class="video-grid">
        <div class="video-card"><iframe id="player7" src="https://www.youtube.com/embed/Ulf8E1XnhgI?enablejsapi=1"
                allowfullscreen
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"></iframe>
        </div>
        <div class="video-card"><iframe id="player8" src="https://www.youtube.com/embed/rXT5HwH-l9w?enablejsapi=1"
                allowfullscreen
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"></iframe>
        </div>
        <div class="video-card"><iframe id="player9" src="https://www.youtube.com/embed/qTbZv5UkoB4?enablejsapi=1"
                allowfullscreen
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"></iframe>
        </div>
    </div>
</div>

<script>
    // Load YouTube IFrame Player API code asynchronously
    var tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);

    var players = [];
    var currentPlaying = null;

    function onYouTubeIframeAPIReady() {
        // Initialize players for each iframe
        for (let i = 1; i <= 9; i++) {
            players[i] = new YT.Player('player' + i, {
                events: {
                    'onStateChange': onPlayerStateChange
                }
            });
        }
    }

    function onPlayerStateChange(event) {
        if (event.data == YT.PlayerState.PLAYING) {
            // Pause other players
            players.forEach(function (player, index) {
                if (player && player !== event.target) {
                    player.pauseVideo();
                }
            });
            currentPlaying = event.target;
        }
    }

    function filterVideos() {
        const value = document.getElementById("category-select").value;
        const sections = {
            crops: document.getElementById("section-crops"),
            vermi: document.getElementById("section-vermi"),
            advanced: document.getElementById("section-advanced")
        };

        for (let key in sections) {
            sections[key].style.display = (value === "all" || value === key) ? "block" : "none";
        }
    }
</script>
{% endblock %}